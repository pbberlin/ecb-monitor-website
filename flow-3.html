<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

  <link rel="stylesheet" href="./css/main-fonts.css" />

</head>

<body>

    <style>

        :root {
            --wImg: 480px;
            --hImg: calc(var(--w) /1.756 *2);

            --w:    calc(var(--wImg) /2);
            --h:    calc(var(--w) /1.756 * 2);
            
            
            --cy:   6rem;  /* no way*/
            --cy:   0;

        }


        body {
            /* font:   16px/1.6; */
            width:  min(60rem, 90%) ;
            margin: 4rem auto;
        }

        p {
            margin:     0;
            padding:    0;
            text-align: justify;
            hyphens:    auto;
        }

        
        .container {
            display: flex;
            /* gap: 2rem; */
            gap: 0;
            position: relative;
        }

        .container .col {
            flex:  1 1 50%;
            max-width: 50%;
        }


        .container div {
            margin: 0;
        }

        .imgOverlay {
            width:  var(--wImg);
            height: var(--hImg);

            margin:  0;
            padding: 0;


            position: absolute; 
            /* top:      50%;  */
            top:       0; 
            left:     50%;
            transform:translate(-50%, var(--cy));
            
            
            z-index:-1;
            /* border: 2px solid grey; */
        }

        .shapeA, .shapeB {
            --poly: polygon();

            float:  right;
            width:  var(--w);
            height: var(--h);

            shape-outside: var(--poly);
            clip-path:     var(--poly);

            background: rgba(200, 200, 200, 0.1);
            shape-margin: 0.01rem;

            margin:  0;
            padding: 0;

            transform:translate(0, var(--cy));

            /* border follows the clipped polygon */
            /* border: 2px dashed red; */
        }


        .shapeB {
            --poly: polygon();
            float:  left;
        }
    </style>

    <h3> Text flow <i>around</i> irregular vignette    </h3>

    <ul>
        <li>Previous examples have text flowing along vignettes on the left and right <i>edge</i>.</li>
        <li>Can we also have vignettes <i>inside</i> text?</li>
        <li>Printed Newspapers sometimes have this.</li>
        <li>Microsoft Word is capable of this since 1995.</li>
        <li>Challenging in webdesign. Requires manually distributing text to boxes.</li>
        <li>Must be <i>two</i> columns of text.</li>
        <li>Columns must be equal width.</li>
        <li>I got the colors  <a href="https://intranet.zew.de/display/KB2/ZEW-Logo%2C+-Farben%2C+-Schrift+%7C+ZEW+Logo%2C+Colours%2C+Font">wrong</a> </li>

    </ul>

    <p>
        Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
        here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
        the box. Add plenty of.
    </p>


    <div class="container">
        <div class="col">
            <div class="shapeA" id="col1"></div>
            <p>
                Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                 Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                 Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline
            </p>
        </div>
        <div class="col">
            <div class="shapeB" id="col2"></div>
            <p>
                Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                 Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline                 Your long text will wrap following the outline long text will wrap following the box. Add plenty of text
                here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
                the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
                following the polygons edge, not the box. Add plenty of text here to see the effect along the irregular
                outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the
                effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
                plenty of text here to see the effect along the irregular outline long text will wrap following
                thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
                long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect
                along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of
                text here to see the effect along the irregular outline long text will wrap following thepolygons edge,
                not the box. Add plenty of text here to see the effect along the irregular outline
            </p>
        </div>

            <img src="./img/median-voter/seesaw.png" 
                class="imgOverlay"
                alt="Seesaw" 
             >


    </div> <!-- end of flex-->


    <p>
        Your long text will wrap following the outline long text will wrap following the box. Add plenty of text here to
        see the effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add
        plenty of text here to see the effect along the irregular outline long text will wrap following the polygons
        edge, not the box. Add plenty of text here to see the effect along the irregular outline long text will wrap
        following thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
        long text will wrap following thepolygons edge, not the box. Add plenty of text here to see the effect along the
        irregular outline long text will wrap following thepolygons edge, not the box. Add plenty of text here to see
        the effect along the irregular outline long text will wrap following thepolygons edge, not the box. Add plenty
        of text here to see the effect along the irregular outline long text will wrap following thepolygons edge, not
        the box. Add plenty of text here to see the effect along the irregular outline long text will wrap following
        thepolygons edge, not the box. Add plenty of text here to see the effect along the irregular outline
    </p>



    <script>

        function formatPolygon(polygonStr) {
            // remove "polygon(" and trailing ")"
            let inner = polygonStr.trim();
            inner = inner.replace(/^polygon\s*\(/, "").replace(/\)$/, "");

            // split points
            let points = inner.split(",").map(p => p.trim());

            // split each into [x,y]
            let pairs = points.map(p => p.split(/\s+/));

            // find max width for alignment
            let maxXLen = Math.max(...pairs.map(pair => pair[0].length));
            let maxYLen = Math.max(...pairs.map(pair => pair[1].length));

            // build formatted lines
            let lines = [];
            for (let pair of pairs) {
                let x = pair[0].padStart(maxXLen, " ");
                let y = pair[1].padStart(maxYLen, " ");
                lines.push(`         ${x} ${y},`);
            }

            // drop the trailing comma from the last
            let last = lines.pop();
            last = last.replace(/,$/, "");
            lines.push(last);

            // join
            const formatted =
                "polygon(\n" +
                   lines.join("\n") +"\n" + 
                ");\n";


            return formatted;
        }




        function mirrorPolygonX(polygonString) {
            try {
                const open  = polygonString.indexOf('(');
                const close = polygonString.lastIndexOf(')');

                if (open === -1 || close === -1) {
                    throw new Error('Invalid polygon() syntax.');
                }

                const inside = polygonString.slice(open + 1, close);
                const points = inside.split(',').map(s => s.trim());
                const mirroredPoints = [];

                for (let i = 0; i < points.length; i++) {
                    const pair = points[i].split(/\s+/);
                    if (pair.length !== 2) {
                        throw new Error('Point does not contain two coordinates: ' + points[i]);
                    }

                    const x = pair[0];
                    const y = pair[1];

                    if (!x.endsWith('%')) {
                        throw new Error('Only percentage x-coordinates are supported: ' + x);
                    }

                    const xNum = parseFloat(x);
                    const mirroredX = (100 - xNum) + '%';
                    mirroredPoints.push(mirroredX + ' ' + y);
                }

                return 'polygon(' + mirroredPoints.join(', ') + ')';
            } catch (e) {
                console.error(e);
                throw e;
            }
        }


        const original1 = `polygon( 0% 0%, 5% 0%, 5%  20%, 60%  30%, 90%  45%, 75%  50%, 75%  60%, 100%  75%, 90%  95%, 50% 100%, 0% 100%)`;
        const original = `polygon( 0% 0%, 
          1%    0%, 
          30%   5%, 
          45%  10%, 
          85%  25%, 
          99.9%  45%, 
          99.9%  57%, 
          55%  70%, 
          20%  82%, 
          20%  88%, 
          28%  89%, 
          47%  95%, 
          47% 100%, 
           0% 100%
    )`;

        const indented  = formatPolygon(original);
        const flatAgain = indented.replace(/\n/g, "").replace(/ {2,}/g, " ");;

        console.log(`${indented}`)
        console.log(`${flatAgain}`)
        console.log(`${original}`)


        const mirrored  = mirrorPolygonX(original);


        const el1 = document.getElementById("col1");
        const el2 = document.getElementById("col2");

        console.log(`${el1.id}`)
        console.log(`${el2.id}`)

        el1.style.setProperty('--poly', mirrored);
        el2.style.setProperty('--poly', original);

        console.log(`set`)
    </script>


</body>

</html>